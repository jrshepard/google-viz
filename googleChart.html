<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">

      // Load the Visualization API and the piechart package.
      google.load('visualization', '1.0', {'packages':['controls']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.setOnLoadCallback(drawChart);

// Callback that creates and populates a data table,
// instantiates the pie chart, passes in the data and
// draws it.
function drawChart() {

        // To see the data that this visualization uses, browse to
  // http://spreadsheets.google.com/ccc?key=pCQbetd-CptGXxxQIG7VFIQ
  var query = new google.visualization.Query(
      'http://spreadsheets.google.com/tq?key=0Ak0LuMkCAPTtdFdoNDg1RGE1NVc5cVNkSVVmeEhmVHc');

  // Apply query language.
  //query.setQuery('SELECT A,D WHERE D > 100 ORDER BY D');

  // Send the query with a callback function.
  query.send(handleQueryResponse);
  }
  
function handleQueryResponse(response) {
  if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
   var data = response.getDataTable();
   
   var officePicker = new google.visualization.ControlWrapper({
		'controlType': 'CategoryFilter',
		'containerId': 'officePicker',
		'options': {
			'filterColumnLabel': 'WORK_GROUP_NAME',
			'ui': {
				'labelStacking': 'horizontal',
				'allowTyping': false,
				'allowMultiple': false
			}
		}
   });
   
   var projectPicker = new google.visualization.ControlWrapper({
		'controlType': 'CategoryFilter',
		'containerId': 'projectPicker',
		'options': {
			'filterColumnLabel': 'PROJECT_NAME',
			'ui': {
				'labelStacking': 'horizontal',
				'allowTyping': false,
				'allowMultiple': false
			}
		}
   });
   
   
   var pieChart = new google.visualization.ChartWrapper({
		'chartType': 'PieChart',
		'containerId': 'chart1',
		'options': {
			'width': 600,
			'height': 600,
			'title': 'Time Charged By Location',
			'chartArea': {'left': 15, 'top': 15, 'right': 0, 'bottom': 0},
			'pieSliceText': 'label'
		},
		'view': {'columns': [2,3]}
   });
   
  new google.visualization.Dashboard(document.getElementById('dashboard'))
	.bind(officePicker, projectPicker)
  .bind(projectPicker, pieChart)
  .draw(data);
}
    </script>
  </head>

  <body>
    <!--Div that will hold the pie chart-->
    <div id="dashboard">
	<div id="officePicker"></div> <br/>
	<div id="projectPicker"></div> <br/>
	<div id="chart1"></div>
  </body>
</html>